var OPMAG_viewport = (function() {
    var f = [];
    var a = "section";
    var d = null;
    var b = null;
    var g = null;
    var e = 0;
    var i = false;
    var l = function(p) {
        if (p) {
            a = p
        }
        c();
        n()
    };
    var n = function() {
        h();
        o();
        m(window.scrollY)
    };
    var c = function() {
        window.addEventListener("scroll", function(p) {
            e = window.pageYOffset;
            if (!i) {
                window.requestAnimationFrame(function() {
                    m(e);
                    i = false
                });
                i = true
            }
        })
    };
    var k = function(q, p, r) {
        return (q - p) / (r - p)
    };

    function j() {
        var r = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
        var q = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;
        var s = $(document).height();
        var p = q / (s - r);
        return {
            documentHeight: s,
            relative: p,
            absolute: p * s
        }
    }
    var m = function(v) {
        var w, u, t, r, x, p;
        var q = null;
        var y = null;
        var z = null;
        for (w = 0, u = f.length; w < u; w++) {
            r = f[w];
            t = r.eRect;
            x = k(v, t.top, t.bottom);
            r.viewportRangeTop = x;
            p = k(v + b, t.top, t.bottom);
            r.viewportRangeBottom = p;
            var s = Math.max(0, Math.abs(p - 0.5) - 0.5);
            if (z === null || z > s) {
                z = s;
                q = r;
                y = w
            }
        }
        document.body.currentSection = q;
        document.body.currentSectionN = y
    };
    var o = function() {
        var r, p, q, s;
        f = document.getElementsByClassName(a);
        for (r = 0, p = f.length; r < p; r++) {
            q = f[r].offsetTop;
            s = f[r].offsetHeight;
            f[r].eRect = {
                top: q,
                height: s,
                bottom: q + s
            }
        }
    };
    var h = function() {
        d = document.body.getBoundingClientRect();
        b = window.innerHeight;
        g = b / 2
    };
    return {
        init: l,
        reset: n
    }
})();